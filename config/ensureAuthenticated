function ensureAuthenticated(req, res, next) {
  if (req.isAuthenticated()) {
    return next(); // Allow access to the route
  }
  req.flash('error_msg', 'Please log in to view that resource');
  res.redirect('/login'); // Redirect to login page if not authenticated
}

module.exports = ensureAuthenticated;